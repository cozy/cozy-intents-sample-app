!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);const o=t=>e=>n=>({method:"POST",headers:{Authorization:`Bearer ${t}`,"content-type":"application/json"},credentials:"include",body:JSON.stringify({data:{type:"io.cozy.intents",attributes:{action:e,type:n,data:{},permissions:[]}}})}),r=t=>{if(t.ok)return t.json();throw new Error("Network response was not ok.")},s=t=>{const{attributes:e,links:n,id:o,meta:{rev:r},type:s}=t.data;return{_id:o,_rev:r,_type:s,attributes:e,links:n,relations:function(t){}}},i=t=>{for(;t.firstChild;)t.removeChild(t.firstChild)},a=t=>{"http://intents-dev.cozy.tools:8080"===t.origin?console.log("internal message received"):"http://drive.cozy.tools:8080"===t.origin&&(t.data.type.includes(":ready")?console.log("intents is ready"):t.data.type.includes(":data")&&(console.log("here are the results",t.data),d=t.data.suggestions,c=document.getElementById("results"),i(c),d.forEach(t=>{const e=document.createElement("li");e.innerText=t.title,c.appendChild(e)})))};var d,c;const u=t=>{console.error((t=>`There has been a problem with your fetch operation: ${t.message}`)(t))},l=t=>{const e=(t=>({url:`//${t.cozyDomain}`,token:t.cozyToken}))(t);return((t,e,n,i)=>window.fetch(`${t}/intents`,o(e)(n)(i)).then(r).then(s))(e.url,e.token,"OPEN","io.cozy.suggestions")};({start:function(){this.bindEvents(),console.log("Application is startingâ€¦")},bindEvents:function(){document.addEventListener("DOMContentLoaded",this.onDOMContentLoaded.bind(this),!1),window.addEventListener("message",a),document.getElementById("message").addEventListener("input",this.onInput.bind(this))},onInput:function(t){const e=this.targetWindows,n=(t=>({query:t}))((t=>t.target.value)(t));e.forEach(t=>{t.postMessage(n,"http://drive.cozy.tools:8080")})},onDOMContentLoaded:function(){const{dataset:t}=document.getElementById("cozy");l(t).then(t=>{const{attributes:{services:e},_id:n}=t;this.targetWindows=e.map(t=>{const{href:e,slug:n}=t;return((t,e)=>{const n=document.createElement("iframe");return n.setAttribute("src",t),n.setAttribute("style","display: none"),n.onload=function(t){console.log(`iframe ${e} is loaded`)},document.getElementById("iframes").appendChild(n),n.contentWindow})(e,n)})}).catch(u)}}).start()}]);